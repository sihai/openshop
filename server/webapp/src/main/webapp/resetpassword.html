<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>
			私人定制俱乐部 | 重置密码
		</title>
		<meta name="description" content="Satorisan es una nueva marca de calzado con tendencia urbana que diseña para personas que no siguen las tendencias preestablecidas, ni las modas sobreexplotadas, y que no tienen miedo de probar algo diferente porque saben lo que les gusta."
		/>
		<meta name="keywords" content="Satorisan, Zapatillas" />
		<meta name="robots" content="INDEX,FOLLOW" />
		<link rel="icon" href="/assets/new/images/favicon.png"
        type="image/x-icon" />
        <link rel="shortcut icon" href="/assets/new/images/favicon.png"
        type="image/x-icon" />
        <!--[if lt IE 7]>
            <script type="text/javascript">
                //<![CDATA[
                var BLANK_URL = '/blank.html';
                var BLANK_IMG = '/assets/new/images/spacer.gif';
                //]]>
                
            </script>
        <![endif]-->
        
		<script src='/assets/new/js/vars.js'></script>
        <script src='/assets/new/js/jquery-1.8.3.min.js'></script>
        <script src='/assets/new/js/jquery-ui-1.8.23.custom.min.js'></script>
        <script src='/assets/new/js/jquery.selectBoxIt.min.js'></script>
        <script src='/assets/new/js/jquery.fileinput.js'></script>
        <script src='/assets/new/js/jquery.nicescroll.min.js'></script>
        <script src='/assets/new/js/jquery.url.js'></script>
        <script src='/assets/new/js/main.js'></script>
        <script src="/assets/h5/js/openshopjssdk.js"></script>
        <script src="/assets/h5/js/openshopjssdk-init.js"></script>
        
        <script type="text/javascript" src="/assets/h5/js/jsbn.js"></script>
		<script type="text/javascript" src="/assets/h5/js/prng4.js"></script>
		<script type="text/javascript" src="/assets/h5/js/rng.js"></script>
		<script type="text/javascript" src="/assets/h5/js/rsa.js"></script>
		<script type="text/javascript" src="/assets/h5/js/base64.js"></script>
		
		<link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/styles.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/myaccount.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/orders.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/address.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/login.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/register.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/helpdesk.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/bootstrap.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/jquery-ui-1.9.1.custom.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/jquery.selectBoxIt.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/checkout.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/base/default/css/widgets.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/base/default/css/storelocator.css"
        media="all" />
        <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/print.css"
        media="print" />
        <script type="text/javascript" src="/assets/new/js/prototype.js"></script>
        <script type="text/javascript" src="/assets/new/js/ccard.js"></script>
        <script type="text/javascript" src="/assets/new/js/validation.js"></script>
        <script type="text/javascript" src="/assets/new/js/builder.js"></script>
        <script type="text/javascript" src="/assets/new/js/effects.js"></script>
        <script type="text/javascript" src="/assets/new/js/dragdrop.js"></script>
        <script type="text/javascript" src="/assets/new/js/controls.js"></script>
        <script type="text/javascript" src="/assets/new/js/slider.js"></script>
        <script type="text/javascript" src="/assets/new/js/js.js"></script>
        <script type="text/javascript" src="/assets/new/js/form.js"></script>
        <script type="text/javascript" src="/assets/new/js/menu.js"></script>
        <script type="text/javascript" src="/assets/new/js/translate.js"></script>
        <script type="text/javascript" src="/assets/new/js/cookies.js"></script>
        <script type="text/javascript" src="/assets/new/js/captcha.js"></script>
        <!--[if lt IE 8]>
            <link rel="stylesheet" type="text/css" href="/assets/new/skin/frontend/default/openshop/css/styles-ie.css"
            media="all" />
        <![endif]-->
        <!--[if lt IE 7]>
            <script type="text/javascript" src="/assets/new/js/ds-sleight.js">
            </script>
            <script type="text/javascript" src="/assets/new/skin/frontend/base/default/js/ie6.js">
            </script>
        <![endif]-->
        <script type="text/javascript">
            //<![CDATA[
            Mage.Cookies.path = '/';
            Mage.Cookies.domain = '.openshop.com';
            //]]>
            
        </script>
        <script type="text/javascript">
            //<![CDATA[
            optionalZipCountries = ["IE", "PA", "HK", "MO"];
            //]]>
            
        </script>
        <script type="text/javascript">
            //<![CDATA[
            window.HDUSeed = 'f3c1798609815a33e0388eed9f3f7b57';
            window.HDUSeedIntId = setInterval(function() {
                if (document.observe) {
                    document.observe('dom:loaded',
                    function() {
                        for (var i = 0; i < document.forms.length; i++) {
                            if (document.forms[i].getAttribute('action') && document.forms[i].getAttribute('action').match('contacts/index/post')) {
                                var el = document.createElement('input');
                                el.type = ('hidden');
                                el.name = 'hdu_seed';
                                el.value = window.HDUSeed;
                                document.forms[i].appendChild(el);

                            }
                        }
                    });
                    clearInterval(window.HDUSeedIntId)
                }
            },
            100)
            //]]>
            
        </script>
        <script type="text/javascript">
            //<![CDATA[
            var Translator = new Translate({
            	"请输入6个以上的字符。 前后空格不算。": "请输入6个以上的字符。 前后空格不算。"
            });
            //]]>
            
        </script>
        <link rel="stylesheet" href="/assets/new/css/enhanced.css"
        />
        <script type="text/javascript">
            if (parent) {
                if (parent.user) {
                    parent.user.updateCart('0');
                    parent.user.updateLogin('0', 'international');
                }
            }
            //$.noConflict();
            jQuery.noConflict();

            var MAGENTO_LANGUAGE_LOCALE = 'en_US';
            var MAGENTO_LANGUAGE = 'en';
        </script>
		
	</head>
	<body class="customer-account-forgotpassword lang-en international ">
		<!-- BEGIN GOOGLE ANALYTICS CODEs -->
		<script type="text/javascript">
			//<![CDATA[
			var _gaq = _gaq || [];

			_gaq.push(['_setAccount', 'UA-38603141-1']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script');
				ga.type = 'text/javascript';
				ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl': 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0];
				s.parentNode.insertBefore(ga, s);
			})();

			//]]>
			
		</script>
		<!-- END GOOGLE ANALYTICS CODE -->
		<div class="wrapper">
			<noscript>
				<div class="global-site-notice noscript">
					<div class="notice-inner">
						<p>
							<strong>
								JavaScript seems to be disabled in your browser.
							</strong>
							<br />
							You must have JavaScript enabled in your browser to utilize the functionality
							of this website.
						</p>
					</div>
				</div>
			</noscript>
			<div class="page">
				<div class="main-container col1-layout">
					<div class="main">
						<div class="col-main">
							<div class="page-title clearfix">
								<h1>
									重置密码
								</h1>
							</div>
							<div class="fieldset clearfix">
								<!-- <h2 class="legend">Retrieve your password here</h2> -->
								<!-- <p class="required">Required Fields *</p> -->
								<p class="desc">
									
								</p>
								<p id="error-msg">
                                                    
                                </p>
								<form ethod="post" id="form-validate" class="clearfix">
									<div class="form_forgot clearfix">
										<label for="password" class="required">
											新密码 *
										</label>
										<input type="password" name="password" alt="新密码" id="password" class="input-text required-entry validate-password" value="" />
									</div>
									
									<div class="form_forgot clearfix">
										
										<label for="cpassword" class="required">
											确认新密码 *
										</label>
										<input type="password" name="cpassword" alt="确认新密码" id="cpassword" class="input-text required-entry validate-cpassword" value="" />
										
									</div>
									
									<div class="form_forgot clearfix">
										<button type="submit" title="提交" class="button has-validation">
											提交
										</button>
									</div>
								</form>
							</div>
							<div class="buttons-set clearfix">
								<p class="back-link">
									<a href="/login.html">
										<small>
											&laquo;
										</small>
										返回登录页面
									</a>
								</p>
							</div>
							<script type="text/javascript">
								//<![CDATA[
								
								var formid = 'form-validate';
                                var dataForm = new VarienForm(formid, true);
                                 
                                var dataForm = new VarienForm(formid, true);
                                new Event.observe(formid, 'submit', function(e){
                                     e.stop();
                                     // ajax
                                     
                                    var password = jQuery('#password').val();
                                  	
                                    window.jsbridge.callHandler('callApi', 
                             				'com.openteach.openshop.server.security.publick.alloc',
                             				'0.0.1',
                             				{},
                             				function(response) {
                             					console.log('com.openteach.openshop.server.security.publick.alloc', response);
                             					if(response.succeed) {
                             						var rsaKey = new RSAKey();
                             						rsaKey.setPublic(b64tohex(response.data.modulus), b64tohex(response.data.exponent));
                             						var enPassword = hex2b64(rsaKey.encrypt(password));
                             						
                             						window.jsbridge.callHandler('callApi', 
                             							'com.openteach.openshop.server.user.password.reset',
                             							'0.0.1',
                             							{
                             								'token': jQuery.getParameter('token'),
                             								'enPassword': enPassword
                             							},
                             							function(response) {
                             								console.log('Got response from com.openteach.openshop.server.user.password.reset', response);
                             								if(response.succeed) {
                             									jQuery('#error-msg').text("重置密码成功，请使用新密码重新登录。");
                             								} else {
                             									// TODO
                             									jQuery('#error-msg').text(response.errorMsg);
                             								}
                             							});
                             					} else {
                             						// TODO
                             						jQuery('#error-msg').text(response.errorMsg);
                             					}
                             			});
                                     
                                 });
                                    
								if(parent && parent.iframeInterface) {
									parent.iframeInterface.ganalyticsTrackEvent({
										name: "LOGIN - FORGOR PASSWORD"
									});
								}
								//]]>
								
							</script>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>

</html>